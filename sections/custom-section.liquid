<div class="customblock">
  <div class="mainsection">
    <div class="mainsection-banner">
      <img
        src="{{ section.settings.main-image | image_url }}"
        width="{{ section.settings.image_width }}px"
        height="{{ section.settings.image_height }}px"
        alt="Main Banner Image"
      >
    </div>

    <div class="mainsection-gallery">
      {% for block in section.blocks %}
        <div class="gallery-item">
          <div class="slider">
            <div class="slides">
              <a href="{{ block.settings.product_image_one_url }}">
                <img 
                  class="slide"
                  src="{{ block.settings.product_image_one | image_url }}"
                  width="{{ block.settings.product_image_width }}px"
                  height="{{ block.settings.product_image_height }}px"
                  alt="{{ block.settings.alt_text }}"
                >
              </a>
              <a href="{{ block.settings.product_image_two_url }}">
                <img
                  class="slide"
                  src="{{ block.settings.product_image_two | image_url }}"
                  width="{{ block.settings.product_image_width }}px"
                  height="{{ block.settings.product_image_height }}px"
                  alt="{{ block.settings.alt_text }}"
                >
              </a>
              <a href="{{ block.settings.product_image_three_url }}">
                <img
                  class="slide"
                  src="{{ block.settings.product_image_three | image_url }}"
                  width="{{ block.settings.product_image_width }}px"
                  height="{{ block.settings.product_image_height }}px"
                  alt="{{ block.settings.alt_text }}"
                >
              </a>
            </div>
            <button class="arrow left-arrow">&#9664;</button>
            <button class="arrow right-arrow">&#9654;</button>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

{% style %}
.customblock {
  width: 100%;
  height: auto;
  background-image: url("{{ section.settings.bg-image | image_url }}");
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center center;
}

.mainsection {
  padding: 10px 0; 
}

.mainsection-banner {
  display: flex;
  justify-content: center;
  align-items: center;
}

.mainsection-gallery {
  padding-top: 10px;
  margin-bottom: -5px;
}

.gallery-item {
  position: relative;
}

.slider {
  position: relative;
  width: 100%;
  overflow: hidden;
}

.slides {
  display: flex;
  transition: transform 0.5s ease;
}

.slide {
  min-width: 100%;
  box-sizing: border-box;
}

.arrow {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0, 0, 0, 0.5);
  color: white;
  border: none;
  padding: 10px;
  cursor: pointer;
}

.left-arrow {
  left: 10px;
}

.right-arrow {
  right: 10px;
}

@media (min-width: 767px) {
  .arrow {
    display: none;
  }
}

@media (max-width: 767px) {
  .mainsection {
    padding: 0;
  }
  .mainsection-gallery {
    padding-top: 0;
  }
}
{% endstyle %}

{% javascript %}
document.addEventListener('DOMContentLoaded', function() {
  const initializeSlider = () => {
    const sliders = document.querySelectorAll('.gallery-item .slider');
    
    sliders.forEach(slider => {
      const slides = slider.querySelector('.slides');
      const slideCount = slides.children.length;
      let currentIndex = 0;

      const showSlide = index => {
        if (index >= slideCount) index = 0;
        if (index < 0) index = slideCount - 1;
        slides.style.transform = `translateX(-${index * 100}%)`;
        currentIndex = index;
      };

      slider.querySelector('.left-arrow').addEventListener('click', () => {
        showSlide(currentIndex - 1);
      });

      slider.querySelector('.right-arrow').addEventListener('click', () => {
        showSlide(currentIndex + 1);
      });

      // Removed the auto-slide functionality
    });
  };

  const updateSlider = () => {
    if (window.innerWidth <= 767) {
      initializeSlider();
    }
  };

  // Initialize slider on load if needed
  updateSlider();

  // Reinitialize slider on resize
  window.addEventListener('resize', updateSlider);
});
{% endjavascript %}

{% schema %}
{
  "name": "Custom Section",
  "settings": [
    {
      "type": "range",
      "id": "image_width",
      "label": "Main Image Width (px)",
      "default": 500,
      "min": 100,
      "max": 1000,
      "step": 10
    },
    {
      "type": "range",
      "id": "image_height",
      "label": "Main Image Height (px)",
      "default": 200,
      "min": 100,
      "max": 500,
      "step": 10
    },
    {
      "type": "image_picker",
      "id": "bg-image",
      "label": "Background Image"
    },
    {
      "type": "image_picker",
      "id": "main-image",
      "label": "Main Image"
    }
  ],
  "blocks": [
    {
      "type": "image_block",
      "name": "Image Block",
      "settings": [
        {
          "type": "url",
          "id": "product_image_one_url",
          "label": "First Image URL"
        },
        {
          "type": "url",
          "id": "product_image_two_url",
          "label": "Second Image URL"
        },
        {
          "type": "url",
          "id": "product_image_three_url",
          "label": "Third Image URL"
        },
        {
          "type": "image_picker",
          "id": "product_image_one",
          "label": "Block Image"
        },
        {
          "type": "image_picker",
          "id": "product_image_two",
          "label": "Block Image"
        },
        {
          "type": "image_picker",
          "id": "product_image_three",
          "label": "Block Image"
        },
        {
          "type": "range",
          "id": "product_image_width",
          "label": "Block Image Width (px)",
          "default": 180,
          "min": 100,
          "max": 1000,
          "step": 10
        },
        {
          "type": "range",
          "id": "product_image_height",
          "label": "Block Image Height (px)",
          "default": 270,
          "min": 100,
          "max": 500,
          "step": 10
        },
        {
          "type": "text",
          "id": "alt_text",
          "label": "Alt Text"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Default Custom Section"
    }
  ]
}
{% endschema %}
